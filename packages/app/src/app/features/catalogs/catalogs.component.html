<div class="page-header">
    <h2 class="page-title">My Catalogs</h2>
    @if (catalogsStore.status() === 'success') {
        <span class="catalog-count" [class.at-limit]="catalogsStore.atLimit()">
            {{ catalogsStore.items().length }} / 20
        </span>
    }
</div>

@if (catalogsStore.loading()) {
    <div class="state-center">
        <mat-spinner diameter="48"/>
    </div>
} @else if (catalogsStore.status() === 'error') {
    <div class="state-center">
        <p class="state-message">Failed to load catalogs.</p>
        <button mat-stroked-button (click)="catalogsStore.load()">
            <mat-icon>refresh</mat-icon>
            Retry
        </button>
    </div>
} @else if (catalogsStore.items().length === 0) {
    <div class="state-center">
        <mat-icon class="empty-icon">video_library</mat-icon>
        <p class="state-message">No catalogs yet.</p>
        <button mat-flat-button (click)="openFormDialog()">
            <mat-icon>add</mat-icon>
            Create your first catalog
        </button>
    </div>
} @else {
    <div class="catalog-grid">
        @for (config of catalogsStore.items(); track config.id) {
            <cc-catalog-card
                    [config]="config"
                    [isDeleting]="catalogsStore.deletingId() === config.id"
                    (editClicked)="openFormDialog(config)"
                    (deleteClicked)="openDeleteConfirm(config)"/>
        }
    </div>
}

@if (catalogsStore.atLimit()) {
    <p class="limit-notice" role="status">
        You've reached the 20-catalog limit. Delete an existing catalog to create a new one.
    </p>
} @else {
    <button mat-fab
            class="fab"
            aria-label="Create new catalog"
            (click)="openFormDialog()">
        <mat-icon>add</mat-icon>
    </button>
}
